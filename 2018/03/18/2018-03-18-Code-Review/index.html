<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Code Review | Kasper's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script></head><link rel="stylesheet" type="text/css" href="/plugins/prettify/doxy.css"><script type="text/javascript" src="/js/ready.js" async></script><body><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">KasperDeng</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.png" width="128" height="128"></a><h1 class="ttl"><a href="/">Kasper's Blog</a></h1></div><p class="m-desc">They're both convinced that a sudden passion joined them. <br>Such certainty is beautiful, but uncertainty is more beautiful still.</p><div class="m-nav"><ul><li><span class="dot">●</span><a href="/archives/">归档</a></li><li><span class="dot">●</span><a href="/categories/">分类</a></li><li><span class="dot">●</span><a href="/tags/">标签</a></li><li><span class="dot">●</span><a href="/about/">关于</a></li><li><span class="dot">●</span><a href="/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" action="/search" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="搜索" onfocus="if(this.value=='搜索'){this.value='';}" onblur="if(this.value==''){this.value='搜索';}"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">Code Review</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/2018/03/18/2018-03-18-Code-Review/">2018-03-18</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><h1 id="Code-Review-是什么？"><a href="#Code-Review-是什么？" class="headerlink" title="Code Review 是什么？"></a>Code Review 是什么？</h1><p><img src="https://pbs.twimg.com/media/CgAbqE6W4AASmwe.jpg" alt="TheSecretToCodeQuality"></p>
<blockquote>
<p>wikipedia: Code review is systematic examination (sometimes referred to as peer review) of computer source code. It is intended to find mistakes overlooked in software development, improving the overall quality of software. </p>
</blockquote>
<ul>
<li>从公司文化和制度上看，Code Review做得最好的，当属Google了。</li>
<li>参考了国内的各大互联网公司，真正把代码评审落地得很好的不多，同样面临着各种问题。既要符合团队的口味，又要契合公司的文化，又不能舍本逐末。</li>
<li>code review是一种文化，不论对工程师而言还是对公司。</li>
</ul>
<h1 id="Code-Review-好处"><a href="#Code-Review-好处" class="headerlink" title="Code Review 好处"></a>Code Review 好处</h1><p><img src="https://www.ibm.com/developerworks/rational/library/11-proven-practices-for-peer-review/image001.gif" alt="DefectDensityVs.Loc"></p>
<ul>
<li>减少代码中的问题，提高下游个团队(QA, Ops, DM)的幸福感。</li>
<li>营造平等的氛围， 激发团队的积极性。</li>
<li>熟悉项目和产品的代码，熟悉团队的代码规范。</li>
</ul>
<h1 id="Code-Review-该怎么做？"><a href="#Code-Review-该怎么做？" class="headerlink" title="Code Review 该怎么做？"></a>Code Review 该怎么做？</h1><h2 id="代码评审-VS-项目进度"><a href="#代码评审-VS-项目进度" class="headerlink" title="代码评审 VS. 项目进度"></a>代码评审 VS. 项目进度</h2><ul>
<li><p>这两者不应该有矛盾，在大目标上应该是一致的。开发团队与项目管理需要达成共识。在操作上，时间进度，风控上要取得平衡，有时候也要特事特办。</p>
</li>
<li><p>个人比较赞同陈皓在<a href="https://coolshell.cn/articles/1302.html" target="_blank" rel="noopener">CODE REVIEW中的几个提示</a>的几个观点，也比较符合目前团队和公司。</p>
<ul>
<li>Code reviews不应该承担发现代码错误的职责<ul>
<li>代码中的bug应该由UT，CT, FT，PT来覆盖</li>
</ul>
</li>
<li>Code reviews不应该成为保证代码风格和编码标准的手段<ul>
<li>代码格式，风格应该通过线下的静态工具就可以分析，统一标准。</li>
</ul>
</li>
</ul>
</li>
<li>Code Review的实现思路</li>
<li>Code Review的meeting是很奢侈的，时间</li>
<li>Code Review的代码量</li>
</ul>
<h2 id="Code-Review-流程"><a href="#Code-Review-流程" class="headerlink" title="Code Review 流程"></a>Code Review 流程</h2><p><img src="https://www.checkmarx.com/wp-content/uploads/2016/02/Blog-Headers-6.png" alt="BestPracticesForThePerfectSecureCodeReview"></p>
<h3 id="效率"><a href="#效率" class="headerlink" title="效率"></a>效率</h3><p><img src="http://s2.quickmeme.com/img/0e/0ee676a657e4f108f1ff2c9a48d35b78823c2d8b9268922d6f5ace8fed9679fe.jpg" alt="largeReview"></p>
<ul>
<li>轻量化的review<ul>
<li>按照一定的度量，分步骤分批量review，比如User Story或者task，避免代码推到重做的风险。</li>
</ul>
</li>
<li>提升review效率<ol>
<li>时间允许的情况下，最好先offline review一下，准备下问题和comments。</li>
<li>可按以下方式进行review<br>a. Review设计思路<br>b. Review设计模式<br>c. Review框架代码<br>d. Review最终代码</li>
</ol>
</li>
</ul>
<h3 id="参与者"><a href="#参与者" class="headerlink" title="参与者"></a>参与者</h3><p><img src="http://mindbowser.com/wp-content/uploads/2016/07/Basic-Code-Reviewer-Code-Review-Checklist.png" alt="reviewer"></p>
<ul>
<li>key reviewers：他们的经验对于代码评审是至关重要的。有足够的key reviwer参与，才能更好提升评审的质量。</li>
<li>peer reviewers and teammates：他们随时会接手未完成的工作，同时也培养key reviwer接班人。</li>
<li>API Users：他们会关心最终给调用的API会是长什么样子的。</li>
<li>Ops team：他们能提出比较多线上的经验与如何收集问题现场的建议。</li>
</ul>
<h3 id="会议"><a href="#会议" class="headerlink" title="会议"></a>会议</h3><p><img src="https://image.slidesharecdn.com/hownottoruncodereviewspdf-141217143831-conversion-gate02/95/how-not-to-run-code-reviews-7-638.jpg?cb=1418827251" alt="CodeReviewMeeting"></p>
<ul>
<li>时间不要太长，否则造成疲惫，评审质量下降。</li>
<li>气氛轻松，吃货就带点零食或者以下午茶的形式来搞。</li>
<li>重大争论点先放一下，线下再详细考量。</li>
</ul>
<h3 id="心态"><a href="#心态" class="headerlink" title="心态"></a>心态</h3><p><img src="http://mindbowser.com/wp-content/uploads/2016/07/Code-Review-2.jpg" alt="TheFearInCodeReview"></p>
<blockquote>
<p>无论是代码作者，还是评审者，都需要一种积极向上的正面的态度，作者需要能够虚心接受别人的建议，因为别人的建议是为了让你做得更好；评审者也需要以一种积极的正面的态度向作者提意见，因为那是和你在一个战壕里的战友。记住，你不是一段代码，你是一个人！</p>
</blockquote>
<ul>
<li>被review的人有一种被虐的感觉，需要放开胸怀接受建议，从错误和失败中学习。</li>
<li>能有人在Code Review和你争论，是一件挺不错的事情。</li>
</ul>
<h3 id="文化"><a href="#文化" class="headerlink" title="文化"></a>文化</h3><ul>
<li>让code review成为一种习惯，一种文化。</li>
<li>code review中总结到的best practices，可以归档到设计概要上做指导。</li>
</ul>
<h3 id="从Code-Review中学习"><a href="#从Code-Review中学习" class="headerlink" title="从Code Review中学习"></a>从Code Review中学习</h3><ul>
<li>代码评审本身就是一个很好的knowledge sharing的过程，让团队中其他成员了解设计思路，实现方式。</li>
<li>相互学习，多思考如何使得设计与实现通用，优雅。修炼自己编码的能力，提升代码质量。</li>
</ul>
<h1 id="Code-Review-工具"><a href="#Code-Review-工具" class="headerlink" title="Code Review 工具"></a>Code Review 工具</h1><ul>
<li>工具对于代码评审来说不是重点，但能提升效率与问题的跟踪。</li>
<li>对于git来说，github的pull request是一种比较好的pre-commit代码评审方式，但比较依赖reviewer，需要一套比较完善的reviewer的机制，否则有阻碍项目的风险。</li>
<li>对应git做VCS来说，有以下这些合适的工具：<ul>
<li><a href="https://www.reviewboard.org/" target="_blank" rel="noopener">Review Board</a> - 免费，可以自己搭建。IDEA intellij和Eclipse都有集成插件。</li>
<li><a href="https://www.gerritcodereview.com/" target="_blank" rel="noopener">gerrit</a> - 跟concluence等系统有机集成。</li>
<li><a href="https://www.atlassian.com/software/crucible" target="_blank" rel="noopener">crucible</a> - one time payment.</li>
</ul>
</li>
</ul>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a href="https://github.com/joho/awesome-code-review">awesome code review</a></li>
<li><a href="http://mindbowser.com/code-review/" target="_blank" rel="noopener">Code Review - An effective process to develop quality softwares</a></li>
<li><a href="https://smartbear.com/learn/code-review/what-is-code-review/" target="_blank" rel="noopener">What is Code Review</a></li>
<li><a href="https://hackernoon.com/code-reviews-in-an-agile-fast-paced-environment-464d5e6ec860" target="_blank" rel="noopener">Code Reviews in an Agile, Fast-Paced Environment</a></li>
<li><a href="http://www.flickering.cn/uncategorized/2014/08/%E8%AE%A9-code-review%E6%88%90%E4%B8%BA%E4%B8%80%E7%A7%8D%E4%B9%A0%E6%83%AF/" target="_blank" rel="noopener">让 Code Review成为一种习惯真的那么重要吗？</a></li>
</ol>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">本文作者：</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">Kasper Deng</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">本文链接：</span><span class="p-copytight-value"><a href="/2018/03/18/2018-03-18-Code-Review/">http://github.com/kasperdeng/2018/03/18/2018-03-18-Code-Review/</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">版权声明：</span><span class="p-copytight-value">本博客所有文章除特殊声明外，均采用<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>许可协议。转载请注明出处 <a href="http://github.com/kasperdeng">Kasper Deng的博客</a>！</span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tags"></i><a href="/tags/Code-Review/">Code Review</a><a href="/tags/Code-Inspection/">Code Inspection</a></span></div></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="next" href="/2018/01/18/2018-01-18-zabbix-jmx/">zabbix jmx &gt;</a></div></section><footer><p>Copyright © 2016 - 2019 <a href="/." rel="nofollow">Kasper's Blog</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/plugins/prettify/prettify.js"></script><script type="text/javascript" src="/js/search.js"></script><script type="text/javascript" src="/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"></body></html>